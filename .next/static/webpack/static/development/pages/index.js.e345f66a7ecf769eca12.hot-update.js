webpackHotUpdate("static\\development\\pages\\index.js",{

/***/ "./components/canvas/index.tsx":
/*!*************************************!*\
  !*** ./components/canvas/index.tsx ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/extends */ "./node_modules/@babel/runtime-corejs2/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_corejs2_core_js_object_values__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs2/core-js/object/values */ "./node_modules/@babel/runtime-corejs2/core-js/object/values.js");
/* harmony import */ var _babel_runtime_corejs2_core_js_object_values__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_core_js_object_values__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs2/regenerator */ "./node_modules/@babel/runtime-corejs2/regenerator/index.js");
/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs2/core-js/promise */ "./node_modules/@babel/runtime-corejs2/core-js/promise.js");
/* harmony import */ var _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/createClass */ "./node_modules/@babel/runtime-corejs2/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/possibleConstructorReturn */ "./node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/getPrototypeOf */ "./node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/assertThisInitialized */ "./node_modules/@babel/runtime-corejs2/helpers/esm/assertThisInitialized.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/inherits */ "./node_modules/@babel/runtime-corejs2/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/defineProperty */ "./node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var _blueprintjs_core__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @blueprintjs/core */ "./node_modules/@blueprintjs/core/lib/esm/index.js");
/* harmony import */ var _emotion_core__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @emotion/core */ "./node_modules/@emotion/core/dist/core.browser.esm.js");
/* harmony import */ var react_konva__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! react-konva */ "./node_modules/react-konva/lib/ReactKonva.js");
/* harmony import */ var react_konva__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(react_konva__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var _BackgroundImage__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./BackgroundImage */ "./components/canvas/BackgroundImage/index.tsx");
/* harmony import */ var _TextArea__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./TextArea */ "./components/canvas/TextArea/index.tsx");
/* harmony import */ var _style__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./style */ "./components/canvas/style.ts");
/* harmony import */ var _Text__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Text */ "./components/canvas/Text/index.tsx");
/* harmony import */ var _Transformer__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Transformer */ "./components/canvas/Transformer/index.tsx");
/* harmony import */ var _CharacteristicsLayer__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./CharacteristicsLayer */ "./components/canvas/CharacteristicsLayer/index.tsx");











var _jsxFileName = "C:\\Users\\Lucas\\Documents\\quiltros\\components\\canvas\\index.tsx";

var __jsx = react__WEBPACK_IMPORTED_MODULE_11___default.a.createElement;

/** @jsx jsx */











var Canvas =
/*#__PURE__*/
function (_Component) {
  Object(_babel_runtime_corejs2_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_9__["default"])(Canvas, _Component);

  function Canvas() {
    var _getPrototypeOf2;

    var _this;

    Object(_babel_runtime_corejs2_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__["default"])(this, Canvas);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = Object(_babel_runtime_corejs2_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__["default"])(this, (_getPrototypeOf2 = Object(_babel_runtime_corejs2_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__["default"])(Canvas)).call.apply(_getPrototypeOf2, [this].concat(args)));

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "state", {
      backgroundImage: null,
      editTextAreaProps: {},
      editTextAreaValue: '',
      onTextAreaClosed: function onTextAreaClosed() {
        return null;
      },
      showEditTextArea: false,
      targetToRestore: []
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "transformerRef", Object(react__WEBPACK_IMPORTED_MODULE_11__["createRef"])());

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "resizeImageHeight", function (img, newHeight, newWidth) {
      var canvas = document.createElement('canvas');
      canvas.height = newHeight;
      canvas.width = newWidth;
      var ctx = canvas.getContext('2d');

      if (!ctx) {
        return _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_3___default.a.resolve(img);
      }

      return new _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_3___default.a(function (resolve, reject) {
        ctx.drawImage(img, 0, 0);
        ctx.drawImage(img, 0, 0, newWidth, newHeight);
        var dataurl = canvas.toDataURL('image/png');
        var newImage = new Image();
        newImage.src = dataurl;
        newImage.addEventListener('load', function () {
          resolve(newImage);
        });
        newImage.addEventListener('error', function () {
          reject(img);
        });
      });
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "getResizedImage", function (image) {
      var height = image.height,
          width = image.width;
      var _this$props = _this.props,
          canvasHeight = _this$props.canvasHeight,
          canvasWidth = _this$props.canvasWidth;
      var imageHeight = height;
      var imageWidth = width; // Resize to go over the canvas height

      imageWidth = imageWidth * (canvasHeight / imageHeight);
      imageHeight = canvasHeight; // Resize to go over the canvas width

      if (canvasWidth > imageWidth) {
        imageHeight = imageHeight * (canvasWidth / imageWidth);
        imageWidth = canvasWidth;
      }

      return _this.resizeImageHeight(image, imageHeight, imageWidth);
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "onTextClick", function (e) {
      e.cancelBubble = true;
      var selectedTextBlock = e.target.name();

      _this.props.onTextBlockSelected(selectedTextBlock);
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "handleStageMouseDown", function (e) {
      var showEditTextArea = false;
      var selectedTextBlock = '';
      var currentTarget = e.currentTarget;
      var targetToRestore = _this.state.targetToRestore;
      var onTextBlockSelected = _this.props.onTextBlockSelected;
      /*const clickedOnStage = target === currentTarget.getStage();
      //const clickedOnTransformer =
      //  target.getParent() && target.getParent().className === 'Transformer';
      //const hasNoName = Boolean(target.name()); // If the thing we are clicking has no name
      const isTextNode = typeof e.currentTarget.stat === 'function'; // TODO: maybe remove this?
      if (isTextNode) {
        selectedTextBlock = e.target.name;
      }*/

      if (targetToRestore) {
        targetToRestore.forEach(function (el) {
          var canvasRef = _this.props.canvasRef.current;
          el.show();
          canvasRef.draw();
        });
      }

      _this.setState({
        showEditTextArea: showEditTextArea
      }, function () {
        return onTextBlockSelected(selectedTextBlock);
      });
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "showElements", function (currentTarget) {
      return function () {
        _this.setState({
          showEditTextArea: false
        }, function () {
          currentTarget.hide();
          var transformerRef = _this.transformerRef.current;
          var canvasRef = _this.props.canvasRef.current;
          currentTarget.show();
          transformerRef.show();
          canvasRef.draw();
        });
      };
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "hideElements", function (currentTarget) {
      currentTarget.hide();
      var transformerRef = _this.transformerRef.current;
      var canvasRef = _this.props.canvasRef.current;
      currentTarget.hide();
      transformerRef.hide();
      canvasRef.draw();
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "onMouseDown", function (evt) {
      var onTextBlockSelected = _this.props.onTextBlockSelected;
      evt.cancelBubble = true;
      var currentTarget = evt.target;
      var id = currentTarget.attrs.id;
      onTextBlockSelected(id);
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "onDoubleClick", function (evt) {
      var currentTarget = evt.currentTarget;
      var transformerRef = _this.transformerRef.current;
      var canvasRef = _this.props.canvasRef.current;

      _this.hideElements(currentTarget); // We will create a textarea absolutely positioned over the canvas
      // And we will render it on a portal
      // first we need to find position for textarea
      // At first lets find position of text node relative to the stage:


      var _currentTarget$absolu = currentTarget.absolutePosition(),
          x = _currentTarget$absolu.x,
          y = _currentTarget$absolu.y;

      var _canvasRef$container$ = canvasRef.container().getBoundingClientRect(),
          left = _canvasRef$container$.left,
          top = _canvasRef$container$.top; // so position of textarea will be the sum of positions above:


      var areaPosition = {
        x: left + x,
        y: top + y
      }; // Create textarea styles to match text on canvas as close as possible
      // (Text rendering on canvas and on the textarea can be different
      // and sometimes it is hard to make it 100% the same)

      var targetToRestore = [currentTarget, transformerRef];
      var showEditTextArea = true;
      var editTextAreaValue = currentTarget.text();
      var editTextAreaProps = {
        color: currentTarget.fill() + '',
        fontFamily: currentTarget.fontFamily() + '',
        fontSize: currentTarget.fontSize() + 'px',
        height: currentTarget.height() + 'px',
        left: areaPosition.x + 'px',
        lineHeight: currentTarget.lineHeight() + '',
        padding: currentTarget.padding() + 'px',
        textAlign: currentTarget.align() + '',
        top: areaPosition.y + 'px',
        transformOrigin: 'left top',
        width: currentTarget.width() + 5 + 'px'
      };

      var onTextAreaClosed = _this.showElements(currentTarget);

      _this.setState({
        editTextAreaProps: editTextAreaProps,
        editTextAreaValue: editTextAreaValue,
        onTextAreaClosed: onTextAreaClosed,
        showEditTextArea: showEditTextArea,
        targetToRestore: targetToRestore
      });
    });

    Object(_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_10__["default"])(Object(_babel_runtime_corejs2_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__["default"])(_this), "onMount", function (ref) {
      _this.transformerRef = ref;
    });

    return _this;
  }

  Object(_babel_runtime_corejs2_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__["default"])(Canvas, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var image, backgroundImage;
      return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.async(function componentDidUpdate$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              image = this.props.image;

              if (!(image && image !== prevProps.image)) {
                _context.next = 6;
                break;
              }

              _context.next = 4;
              return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.awrap(this.getResizedImage(image));

            case 4:
              backgroundImage = _context.sent;
              this.setState({
                backgroundImage: backgroundImage
              });

            case 6:
            case "end":
              return _context.stop();
          }
        }
      }, null, this);
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          backgroundImage = _this$state.backgroundImage,
          showEditTextArea = _this$state.showEditTextArea,
          editTextAreaProps = _this$state.editTextAreaProps,
          onTextAreaClosed = _this$state.onTextAreaClosed;
      var _this$props2 = this.props,
          canvasTexts = _this$props2.canvasTexts,
          onRef = _this$props2.onRef,
          onTextChanged = _this$props2.onTextChanged,
          canvasHeight = _this$props2.canvasHeight,
          canvasWidth = _this$props2.canvasWidth,
          characteristics = _this$props2.characteristics;
      var textBlocks = canvasTexts.textBlocks,
          selectedTextBlock = canvasTexts.selectedTextBlock; //const test = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="venus" class="svg-inline--fa fa-venus fa-w-9" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 288 512"><path fill="currentColor" d="M288 176c0-79.5-64.5-144-144-144S0 96.5 0 176c0 68.5 47.9 125.9 112 140.4V368H76c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h36v36c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-36h36c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-36v-51.6c64.1-14.5 112-71.9 112-140.4zm-224 0c0-44.1 35.9-80 80-80s80 35.9 80 80-35.9 80-80 80-80-35.9-80-80z"></path></svg>'

      return Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_12__["Card"], {
        elevation: _blueprintjs_core__WEBPACK_IMPORTED_MODULE_12__["Elevation"].ONE,
        css: _style__WEBPACK_IMPORTED_MODULE_17__["canvasStyle"],
        __source: {
          fileName: _jsxFileName,
          lineNumber: 239
        },
        __self: this
      },  true && Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(react_konva__WEBPACK_IMPORTED_MODULE_14__["Stage"], {
        ref: onRef,
        width: canvasWidth,
        height: canvasHeight,
        onClick: this.handleStageMouseDown,
        __source: {
          fileName: _jsxFileName,
          lineNumber: 241
        },
        __self: this
      }, Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_BackgroundImage__WEBPACK_IMPORTED_MODULE_15__["default"], {
        backgroundImage: backgroundImage,
        canvasHeight: canvasHeight,
        canvasWidth: canvasWidth,
        __source: {
          fileName: _jsxFileName,
          lineNumber: 247
        },
        __self: this
      }), Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(react_konva__WEBPACK_IMPORTED_MODULE_14__["Layer"], {
        __source: {
          fileName: _jsxFileName,
          lineNumber: 248
        },
        __self: this
      }, _babel_runtime_corejs2_core_js_object_values__WEBPACK_IMPORTED_MODULE_1___default()(textBlocks).map(function (textBlock) {
        return Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_Text__WEBPACK_IMPORTED_MODULE_18__["default"], Object(_babel_runtime_corejs2_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__["default"])({
          key: textBlock.id
        }, textBlock, {
          maxHeight: canvasHeight,
          maxWidth: canvasWidth,
          onClick: _this2.onTextClick,
          onDoubleClick: _this2.onDoubleClick,
          onMouseDown: _this2.onMouseDown,
          __source: {
            fileName: _jsxFileName,
            lineNumber: 250
          },
          __self: this
        }));
      }), Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_CharacteristicsLayer__WEBPACK_IMPORTED_MODULE_20__["default"], {
        canvasHeight: canvasHeight,
        canvasWidth: canvasWidth,
        characteristics: characteristics,
        __source: {
          fileName: _jsxFileName,
          lineNumber: 261
        },
        __self: this
      }), Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_Transformer__WEBPACK_IMPORTED_MODULE_19__["default"], {
        resizeEnabled: true,
        rotateEnabled: true,
        borderEnabled: true,
        onMount: this.onMount,
        selectedShapeName: selectedTextBlock,
        __source: {
          fileName: _jsxFileName,
          lineNumber: 263
        },
        __self: this
      }))), showEditTextArea && textBlocks[selectedTextBlock].text && Object(_emotion_core__WEBPACK_IMPORTED_MODULE_13__["jsx"])(_TextArea__WEBPACK_IMPORTED_MODULE_16__["default"], {
        onTextAreaClosed: onTextAreaClosed,
        onTextAreaChanged: onTextChanged,
        selectedtextblockid: selectedTextBlock,
        value: textBlocks[selectedTextBlock].text,
        style: editTextAreaProps,
        maxWidth: canvasWidth,
        maxHeight: canvasHeight,
        __source: {
          fileName: _jsxFileName,
          lineNumber: 274
        },
        __self: this
      }));
    }
  }]);

  return Canvas;
}(react__WEBPACK_IMPORTED_MODULE_11__["Component"]);

/* harmony default export */ __webpack_exports__["default"] = (Canvas);

/***/ })

})
//# sourceMappingURL=index.js.e345f66a7ecf769eca12.hot-update.js.map